<template>
  <el-container style="height: 100%">
    <el-header>
      <el-menu default-active="/" :router="true">
        <el-menu-item index="/">è¿”å›ä¸»é¡µ</el-menu-item>
      </el-menu>
    </el-header>
    <el-main>
      <el-row class="fillheight">
        <el-col :span="6"
          ><el-collapse v-model="activeName" accordion>
            <el-collapse-item title="å®ç°åŠŸèƒ½" name="1">
              <div>
                ç™»å½•ï¼Œæ³¨å†Œï¼Œæ·»åŠ å¥½å‹ï¼Œä¿®æ”¹ä¸ªäººä¿¡æ¯ï¼Œä¿®æ”¹å¥½å‹å¤‡æ³¨ï¼Œæ·»åŠ æ‹‰é»‘åˆ é™¤å¥½å‹æ“ä½œï¼Œ
              </div>
              <div>
                websorck
              </div>
            </el-collapse-item>
            <el-collapse-item title="åé¦ˆ Feedback" name="2">
              <div>
                æ§åˆ¶åé¦ˆï¼šé€šè¿‡ç•Œé¢æ ·å¼å’Œäº¤äº’åŠ¨æ•ˆè®©ç”¨æˆ·å¯ä»¥æ¸…æ™°çš„æ„ŸçŸ¥è‡ªå·±çš„æ“ä½œï¼›
              </div>
              <div>
                é¡µé¢åé¦ˆï¼šæ“ä½œåï¼Œé€šè¿‡é¡µé¢å…ƒç´ çš„å˜åŒ–æ¸…æ™°åœ°å±•ç°å½“å‰çŠ¶æ€ã€‚
              </div>
            </el-collapse-item>
            <el-collapse-item title="æ•ˆç‡ Efficiency" name="3">
              <div>ç®€åŒ–æµç¨‹ï¼šè®¾è®¡ç®€æ´ç›´è§‚çš„æ“ä½œæµç¨‹ï¼›</div>
              <div>
                æ¸…æ™°æ˜ç¡®ï¼šè¯­è¨€è¡¨è¾¾æ¸…æ™°ä¸”è¡¨æ„æ˜ç¡®ï¼Œè®©ç”¨æˆ·å¿«é€Ÿç†è§£è¿›è€Œä½œå‡ºå†³ç­–ï¼›
              </div>
              <div>
                å¸®åŠ©ç”¨æˆ·è¯†åˆ«ï¼šç•Œé¢ç®€å•ç›´ç™½ï¼Œè®©ç”¨æˆ·å¿«é€Ÿè¯†åˆ«è€Œéå›å¿†ï¼Œå‡å°‘ç”¨æˆ·è®°å¿†è´Ÿæ‹…ã€‚
              </div>
            </el-collapse-item>
            <el-collapse-item title="å¯æ§ Controllability" name="4">
              <div>
                ç”¨æˆ·å†³ç­–ï¼šæ ¹æ®åœºæ™¯å¯ç»™äºˆç”¨æˆ·æ“ä½œå»ºè®®æˆ–å®‰å…¨æç¤ºï¼Œä½†ä¸èƒ½ä»£æ›¿ç”¨æˆ·è¿›è¡Œå†³ç­–ï¼›
              </div>
              <div>
                ç»“æœå¯æ§ï¼šç”¨æˆ·å¯ä»¥è‡ªç”±çš„è¿›è¡Œæ“ä½œï¼ŒåŒ…æ‹¬æ’¤é”€ã€å›é€€å’Œç»ˆæ­¢å½“å‰æ“ä½œç­‰ã€‚
              </div>
            </el-collapse-item>
          </el-collapse></el-col
        >
        <!--ä¸»ç•Œé¢-->
        <el-col :span="12" class="fillheight" style="max-height: 600px">
          <el-row class="fillheight">
            <!--å·¦ä¾§èœå•æ -->
            <el-col
              :span="2"
              class="fillheight"
              style="
                background: #2b2b2b;
                border-top-left-radius: 4px;
                border-bottom-left-radius: 4px;
              "
            >
              <div
                class="flex fillheight"
                style="flex-direction: column; justify-content: space-between"
              >
                <!--å·¦ä¾§ä¸Šéƒ¨-->
                <div>
                  <!--å¤´åƒ-->
                  <div @click="showmyself()">
                    <el-avatar
                      class="aligncenter"
                      :size="40"
                      shape="square"
                      style="margin-top: 20px; margin-bottom: 20px"
                      :src="userinfo.headimg"
                    />
                  </div>
                  <!--ä¿¡æ¯-->
                  <div
                    class="el-icon-chat-round aligncenter"
                    style="
                      width: 26px;
                      line-height: 40px;
                      font-size: 26px;
                      color: #484b4e;
                    "
                    @click="showMessageList"
                  ></div>
                  <!--å¥½å‹-->
                  <div
                    class="el-icon-notebook-1 aligncenter"
                    style="
                      width: 26px;
                      line-height: 40px;
                      font-size: 26px;
                      color: #484b4e;
                    "
                    @click="showFriendList"
                  ></div>
                </div>
                <!--å·¦ä¾§ä¸‹éƒ¨-->
                <div>
                  <el-popover
                    placement="right-end"
                    width="100"
                    trigger="click"
                    style="padding: 0px"
                    visible-arrow="false"
                  >
                    <el-menu
                      style="width: 100px"
                      active-text-color="#2f3032"
                      background-color="#2b2b2a"
                      text-color="#8c8c8c"
                    >
                      <el-menu-item @click="dialogLoginVisible = true"
                        >ç™»å½•</el-menu-item
                      >
                      <el-menu-item @click="dialogRegistVisible = true"
                        >æ³¨å†Œ</el-menu-item
                      >
                      <el-menu-item @click="dialogAddFriendVisible = true"
                        >æ·»åŠ å¥½å‹</el-menu-item
                      >
                      <!--<el-menu-item @click="dialogSettingVisible = true">è®¾ç½®</el-menu-item>
                      <el-menu-item @click="dialogAddressVisible = true">æ³¨é”€</el-menu-item>-->
                    </el-menu>
                    <div
                      class="el-icon-more-outline aligncenter"
                      slot="reference"
                      style="
                        width: 26px;
                        line-height: 50px;
                        font-size: 26px;
                        color: #484b4e;
                      "
                    ></div>
                  </el-popover>
                </div>
              </div>
            </el-col>
            <!---->
            <!--ä¸­é—´åˆ—è¡¨åˆ—-->
            <el-col :span="8" style="background: #eae8e7" class="fillheight">
              <!--æœç´¢æ -->
              <div class="flex" style="padding: 20px 10px">
                <!--è¾“å…¥æ¡†-->
                <div class="el-input el-input--mini el-input--prefix">
                  <input
                    type="text"
                    autocomplete="off"
                    placeholder="æœç´¢"
                    class="el-input__inner"
                    style="background: #dbd9d8"
                  />
                  <span class="el-input__prefix">
                    <i
                      class="el-input__icon el-icon-search"
                      style="color: #818181"
                    ></i>
                  </span>
                </div>
                <!--æ·»åŠ æŒ‰é’®-->
                <el-button
                  icon="el-icon-plus"
                  size="mini"
                  style="padding: 6px; margin-left: 10px; background: #dbd9d8"
                ></el-button>
              </div>
              <!--å¥½å‹åˆ—è¡¨-->
              <div
                v-if="showList == 'friend'"
                class="scroll_config"
                style="overflow-y: scroll; height: 85%"
              >
                <el-collapse>
                  <el-collapse-item name="1">
                    <template slot="title">
                      <i
                        class="el-icon-circle-close"
                        style="
                          color: #fff;
                          background-color: #a0a0a0;
                          font-size: 28px;
                          border-radius: 4px;
                          margin: 12px;
                          padding: 4px;
                        "
                      />é»‘åå•
                    </template>
                    <div
                      v-for="(item, index) in friendList"
                      :key="index"
                      @click="showFriendInfo(item)"
                    >
                      <div v-if="item.relation == 0" class="flex list-link">
                        <div style="margin: 12px; width: 36px; height: 36px">
                          <el-avatar
                            shape="square"
                            :size="36"
                            :src="item.headimg"
                          ></el-avatar>
                        </div>
                        <!--æ˜µç§°/å¤‡æ³¨-->
                        <div
                          style="
                            padding-top: 20px;
                            font-size: 14px;
                            overflow: hidden;
                            white-space: nowrap;
                            text-overflow: ellipsis;
                          "
                        >
                          {{ item.notes == "" ? item.nickname : item.notes }}
                        </div>
                      </div>
                    </div>
                    <!--å¤´åƒ-->
                  </el-collapse-item>
                  <el-collapse-item name="2">
                    <template slot="title">
                      <i
                        class="el-icon-circle-plus-outline"
                        style="
                          color: #fff;
                          background-color: #ffa020;
                          font-size: 28px;
                          border-radius: 4px;
                          margin: 12px;
                          padding: 4px;
                        "
                      />å¥½å‹è¯·æ±‚
                    </template>
                    <div
                      v-for="(item, index) in friendList"
                      :key="index"
                      @click="showFriendInfo(item)"
                    >
                      <div v-if="item.relation == 2" class="flex list-link">
                        <div style="margin: 12px; width: 36px; height: 36px">
                          <el-avatar
                            shape="square"
                            :size="36"
                            :src="item.headimg"
                          ></el-avatar>
                        </div>
                        <!--æ˜µç§°/å¤‡æ³¨-->
                        <div
                          style="
                            padding-top: 20px;
                            font-size: 14px;
                            overflow: hidden;
                            white-space: nowrap;
                            text-overflow: ellipsis;
                          "
                        >
                          {{ item.notes == "" ? item.nickname : item.notes }}
                        </div>
                      </div>
                    </div>
                  </el-collapse-item>
                </el-collapse>
                <!--å¾ªç¯èµ‹å€¼-->
                <div
                  v-for="(item, index) in friendList"
                  :key="index"
                  @click="showFriendInfo(item)"
                >
                  <div v-if="item.relation == 1" class="flex list-link">
                    <div style="margin: 12px; width: 36px; height: 36px">
                      <el-avatar
                        shape="square"
                        :size="36"
                        :src="item.headimg"
                      ></el-avatar>
                    </div>
                    <!--æ˜µç§°/å¤‡æ³¨-->
                    <div
                      style="
                        padding-top: 20px;
                        font-size: 14px;
                        overflow: hidden;
                        white-space: nowrap;
                        text-overflow: ellipsis;
                      "
                    >
                      {{ item.notes == "" ? item.nickname : item.notes }}
                    </div>
                  </div>
                </div>
              </div>
              <!--æ¶ˆæ¯åˆ—è¡¨-->
              <div
                v-if="showList == 'message'"
                class="scroll_config"
                style="overflow-y: scroll; height: 85%"
              >
                <div
                  v-for="(item, index) in messageList"
                  :key="index"
                  class="flex list-link"
                  @click="openMessage(item)"
                  @contextmenu.prevent="rightClick(item.fuid)"
                >
                  <!--æ¶ˆæ¯badgeã€å¤´åƒ-->
                  <div style="margin: 12px">
                    <el-badge
                      v-if="item.newmessage > 0"
                      :value="item.newmessage"
                      class="item"
                    >
                      <el-avatar
                        shape="square"
                        :size="36"
                        :src="item.headimg"
                      ></el-avatar>
                    </el-badge>
                    <el-avatar
                      v-else
                      shape="square"
                      :size="36"
                      :src="item.headimg"
                    ></el-avatar>
                  </div>
                  <div style="width: 100%">
                    <!--å³ä¸Šéƒ¨åˆ†-->
                    <div
                      class="flex"
                      style="
                        width: 100%;
                        justify-content: flex-end;
                        padding-top: 10px;
                      "
                    >
                      <!--æ˜µç§°/å¤‡æ³¨-->
                      <div style="flex: 1; font-size: 12px">
                        <div
                          style="
                            width: 90%;
                            text-overflow: ellipsis;
                            overflow: hidden;
                            white-space: nowrap;
                          "
                        >
                          {{ item.notes == "" ? item.nickname : item.notes }}
                        </div>
                      </div>
                      <!--æœ€è¿‘ä¸€æ¡ä¿¡æ¯æ—¶é—´-->
                      <div
                        class="c696969"
                        style="width: 70px; margin-left: 4px; font-size: 10px"
                      >
                        {{
                          item.chattime !== null
                            ? chattimeFormatter(item.chattime)
                            : ""
                        }}
                      </div>
                    </div>
                    <!--æœ€è¿‘ä¸€æ¡æ¶ˆæ¯-->
                    <div
                      class="c696969"
                      style="
                        width: 180px;
                        font-size: 12px;
                        overflow: hidden;
                        white-space: nowrap;
                        text-overflow: ellipsis;
                        line-height: 24px;
                      "
                    >
                      {{ item.body }}
                    </div>
                  </div>
                </div>
              </div>
            </el-col>
            <!--å³ä¾§è¯¦ç»†çª—å£åˆ—-->
            <el-col :span="14" style="background: #f5f5f5" class="fillheight">
              <!--å¦‚åˆå§‹åŒ–åˆ—-->
              <div
                v-if="showBox == 'index'"
                style="
                  margin-top: 120px;
                  line-height: 14px;
                  font-size: 14px;
                  word-space: 0px;
                  letter-spacing: 0px;
                "
              >
                <div>
                  &nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__
                </div>
                <div>
                  &nbsp;/\&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;/\&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\&nbsp;\
                </div>
                <div>
                  &nbsp;\&nbsp;\&nbsp;\___&nbsp;&nbsp;&nbsp;__&nbsp;\&nbsp;\&nbsp;&nbsp;\&nbsp;&nbsp;\&nbsp;\&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_____&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_______&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;_&nbsp;&nbsp;\_\&nbsp;\
                </div>
                <div>
                  &nbsp;&nbsp;\&nbsp;\&nbsp;&nbsp;_&nbsp;`\/\&nbsp;_&nbsp;`\&nbsp;\&nbsp;&nbsp;\&nbsp;&nbsp;\&nbsp;\&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;/\&nbsp;&nbsp;___\/\&nbsp;&nbsp;\&nbsp;&nbsp;/\&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;/\&nbsp;&nbsp;__`\/\&nbsp;\/&nbsp;`\/'_`&nbsp;&nbsp;\
                </div>
                <div>
                  &nbsp;&nbsp;&nbsp;\&nbsp;\&nbsp;\/\&nbsp;\&nbsp;\&nbsp;_&nbsp;/\&nbsp;\&nbsp;&nbsp;\_\&nbsp;\&nbsp;&nbsp;\_&nbsp;\&nbsp;\&nbsp;\L\&nbsp;\&nbsp;\&nbsp;&nbsp;\/&nbsp;&nbsp;\/&nbsp;&nbsp;/\&nbsp;\&nbsp;\L\&nbsp;\&nbsp;\&nbsp;&nbsp;/\/\&nbsp;\L\&nbsp;\
                </div>
                <div>
                  &nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;\_\&nbsp;\_\&nbsp;\__/\&nbsp;\&nbsp;___\&nbsp;\___&nbsp;\&nbsp;\&nbsp;&nbsp;___\&nbsp;\__/\__/&nbsp;&nbsp;&nbsp;\&nbsp;\____\&nbsp;\_\&nbsp;\&nbsp;\___,_\
                </div>
                <div>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/_/\/_/\/__/&nbsp;\/___/\/___/&nbsp;\/___/&nbsp;\/_/\/_/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/___/\/_/&nbsp;&nbsp;\/__,_&nbsp;/
                </div>
              </div>
              <!--å¦‚å¥½å‹èµ„æ–™åˆ—-->
              <div v-if="showBox == 'info'" style="padding: 60px">
                <div class="flex">
                  <div>
                    <el-avatar
                      shape="square"
                      :size="80"
                      :src="info.headimg"
                    ></el-avatar>
                  </div>
                  <div style="margin-left: 20px">
                    <div>{{ info.nickname }}</div>
                    <div
                      style="font-size: 12px; color: #696969; margin-top: 16px"
                    >
                      {{ info.signature }}
                    </div>
                  </div>
                </div>
                <el-divider></el-divider>
                <div>
                  <div class="flex lh40">
                    <span class="w50 c696969" style>å¤‡æ³¨ï¼š</span>
                    <input
                      class="inputupdate"
                      style="
                        padding: 0;
                        border: 0;
                        height: 38px;
                        font-size: 16px;
                        background: #ffffff00;
                      "
                      :value="info.notes"
                      @change="updateFriendNote($event)"
                    />
                  </div>
                  <div class="flex lh40">
                    <span class="w50 c696969">åœ°å€ï¼š</span>
                    <div>
                      <span>{{ info.address }}</span>
                    </div>
                  </div>
                  <div class="flex lh40">
                    <span class="w50 c696969">è´¦å·ï¼š</span>
                    <span>{{ info.fuid }}</span>
                  </div>
                  <div class="flex lh40">
                    <span class="w50 c696969">æ€§åˆ«ï¼š</span>
                    <div class="lh40">
                      <img
                        v-if="info.sex == 0"
                        src="http://api.25cl.cn/static/img/0.png"
                        style="width: 16px; height: 16px; padding-top: 12px"
                      />
                      <img
                        v-else
                        src="http://api.25cl.cn/static/img/1.png"
                        style="width: 16px; height: 16px; padding-top: 12px"
                      />
                    </div>
                  </div>
                </div>
                <el-divider></el-divider>
                <div v-if="info.relation < 2">
                  <el-button type="success" @click="goMessageBox"
                    >å‘é€ä¿¡æ¯</el-button
                  >
                  <el-button
                    v-if="info.relation == 0"
                    type="info"
                    @click="friendCommand('offblacklist')"
                    >å–æ¶ˆæ‹‰é»‘</el-button
                  >
                  <el-button
                    v-if="info.relation == 1"
                    type="info"
                    @click="friendCommand('onblacklist')"
                    >æ‹‰é»‘</el-button
                  >
                  <el-button type="info" @click="friendCommand('reject')"
                    >åˆ é™¤å¥½å‹</el-button
                  >
                </div>
                <div v-else>
                  <el-button type="success" @click="friendCommand('agree')"
                    >åŒæ„</el-button
                  >
                  <el-button type="info" @click="friendCommand('reject')"
                    >æ‹’ç»</el-button
                  >
                </div>
              </div>
              <!--å¦‚èŠå¤©çª—å£åˆ—-->
              <div
                v-if="showBox == 'message'"
                style="height: 100%; display: flex; flex-direction: column"
              >
                <!--æ ‡é¢˜æ -->
                <div
                  class="bgf5"
                  style="
                    height: 60px;
                    border-bottom: 1px;
                    border-bottom-style: solid;
                    line-height: 60px;
                    font-size: 18px;
                    border-color: #e0e0e0;
                    padding-left: 20px;
                  "
                >
                  {{
                    nowmessagefriend.notes == ""
                      ? nowmessagefriend.nickname
                      : nowmessagefriend.notes
                  }}
                </div>
                <!--ä¸»ä½“æ -->
                <div
                  ref="main1"
                  class="bgf5 scroll_config"
                  style="flex: 1; overflow-y: auto"
                >
                  <div style="height: 100%">
                    <div v-for="(item, index) in nowmessagelist" :key="index">
                      <div
                        v-if="item.status == 0"
                        class="flex"
                        style="width: 100%; padding-top: 10px"
                      >
                        <el-avatar
                          shape="square"
                          :src="nowmessagefriend.headimg"
                          :size="40"
                          style="margin-left: 20px"
                        ></el-avatar>
                        <div
                          style="
                            margin-left: 10px;
                            margin-right: 20%;
                            padding: 10px;
                            background-color: #ffffff;
                            font-size: 14px;
                            border-radius: 4px;
                            border: 1px;
                            border-style: solid;
                            border-color: #e0e0e0;
                          "
                        >
                          {{ item.body }}
                        </div>
                      </div>
                      <div
                        v-if="item.status == 1"
                        class="flex"
                        style="
                          width: 100%;
                          padding-top: 10px;
                          justify-content: flex-end;
                        "
                      >
                        <div
                          style="
                            margin-right: 10px;
                            margin-left: 20%;
                            padding: 10px;
                            background-color: #9eea6a;
                            font-size: 14px;
                            border-radius: 4px;
                            border: 1px;
                            border-style: solid;
                            border-color: #e0e0e0;
                          "
                        >
                          {{ item.body }}
                        </div>
                        <el-avatar
                          shape="square"
                          :src="userinfo.headimg"
                          :size="40"
                          style="margin-right: 20px"
                        ></el-avatar>
                      </div>
                    </div>
                  </div>
                </div>
                <!--è¾“å…¥æ -->
                <div
                  style="
                    border-top: 1px;
                    border-top-style: solid;
                    border-color: #e0e0e0;
                    background-color: #ffffff;
                    padding-left: 20px;
                    padding-right: 20px;
                    height: 120px;
                  "
                >
                  <!--å·¥å…·æ -->
                  <div style="height: 30px; background-color: #ffffff">
                    <el-dropdown
                      trigger="click"
                      :hide-on-click="false"
                      placement="top"
                    >
                      <span class="el-dropdown-link">ğŸ˜ƒ</span>
                      <el-dropdown-menu slot="dropdown">
                        <el-dropdown-item style="width: 250px">
                          <a
                            v-for="item in emoji"
                            :key="item"
                            @click="inputemoji(item)"
                            style="font-size: 18px"
                            >{{ item }}</a
                          >
                        </el-dropdown-item>
                      </el-dropdown-menu>
                    </el-dropdown>
                  </div>
                  <!--å‘é€å†…å®¹æ -->
                  <div style="width: 100%">
                    <textarea
                      v-model="sendmessage"
                      placeholder
                      style="
                        height: 60px;
                        border: none;
                        resize: none;
                        width: 100%;
                        padding: 0px;
                        outline: none;
                      "
                    />
                  </div>
                  <!--å‘é€æŒ‰é’®-->
                  <div
                    class="flex"
                    style="
                      justify-content: flex-end;
                      margin-left: auto;
                      padding-right: 20px;
                    "
                    @click="sendMessage"
                  >
                    <el-button type style="padding: 4px 20px">å‘é€</el-button>
                  </div>
                </div>
              </div>
              <!--å¦‚ä¸ªäººèµ„æ–™åˆ—-->
              <div v-if="showBox == 'myself'" style="padding: 60px">
                <!--åŸºç¡€ä¿¡æ¯-->
                <div class="flex">
                  <!--å¤´åƒ-->
                  <div style="width: 80px; height: 80px">
                    <el-upload
                      class="avatar-uploader"
                      action="http://api.25cl.cn/project/chat/headimgupload"
                      :headers="headers"
                      :show-file-list="false"
                      :on-success="handleAvatarSuccess"
                      :before-upload="beforeAvatarUpload"
                      style="width: 80px; height: 80px"
                    >
                      <el-avatar
                        v-if="myselfinfo.headimg"
                        :src="myselfinfo.headimg"
                        class="avatar"
                        :size="80"
                        shape="square"
                      />
                    </el-upload>
                  </div>
                  <div style="margin-left: 20px">
                    <input
                      class="inputupdate"
                      style="
                        padding: 0;
                        margin-top: 4px;
                        border: 0;
                        height: 24px;
                        font-size: 16px;
                        background: #ffffff00;
                      "
                      v-model="myselfinfo.nickname"
                    />
                    <input
                      class="inputupdate"
                      style="
                        padding: 0;
                        margin-top: 4px;
                        border: 0;
                        height: 20px;
                        font-size: 12px;
                        background: #ffffff00;
                        color: #696969;
                      "
                      v-model="myselfinfo.signature"
                    />
                  </div>
                </div>
                <el-divider></el-divider>
                <div>
                  <div class="flex lh40">
                    <span class="w50 c696969">è´¦å·ï¼š</span>
                    <span>{{ myselfinfo.uid }}</span>
                  </div>
                  <div class="flex lh40">
                    <span class="w50 c696969">ç”Ÿæ—¥ï¼š</span>
                    <el-date-picker
                      class="dateinput"
                      v-model="myselfinfo.birthday"
                      type="date"
                      format="yyyy å¹´ MM æœˆ dd æ—¥"
                      value-format="yyyy-MM-dd"
                      prefix-icon="none"
                      :clearable="false"
                      style="padding: 0px"
                    ></el-date-picker>
                  </div>
                  <div class="flex lh40" @click="dialogAddressVisible = true">
                    <span class="w50 c696969">åœ°å€ï¼š</span>
                    <span>{{ myselfinfo.address }}</span>
                  </div>
                  <div class="flex lh40">
                    <span class="w50 c696969">æ€§åˆ«ï¼š</span>
                    <div class="lh40">
                      <img
                        v-if="myselfinfo.sex == 0"
                        src="http://api.25cl.cn/static/img/0.png"
                        style="width: 16px; height: 16px; padding-top: 12px"
                        @click="myselfinfo.sex = 1"
                      />
                      <img
                        v-else
                        src="http://api.25cl.cn/static/img/1.png"
                        style="width: 16px; height: 16px; padding-top: 12px"
                        @click="myselfinfo.sex = 0"
                      />
                    </div>
                  </div>
                </div>
                <el-divider></el-divider>
                <el-button @click="updateMyself">ä¿å­˜ä¿®æ”¹</el-button>
              </div>
            </el-col>
          </el-row>
        </el-col>
        <el-col :span="6"></el-col>
        <el-dialog
          title="ç™»å½•ç•Œé¢"
          :visible.sync="dialogLoginVisible"
          width="300px"
        >
          <el-form>
            <el-form-item label="ç”¨æˆ·å" label-width="60px">
              <el-input v-model="username"></el-input>
            </el-form-item>
            <el-form-item label="å¯†ç " label-width="60px">
              <el-input v-model="password"></el-input>
            </el-form-item>
            <el-form-item>
              <el-button type="primary" @click="login">ç™»å½•</el-button>
              <el-button @click="dialogLoginVisible = false">å–æ¶ˆ</el-button>
            </el-form-item>
          </el-form>
        </el-dialog>
        <el-dialog
          title="æ³¨å†Œç•Œé¢"
          :visible.sync="dialogRegistVisible"
          width="500px"
        >
          <el-form
            :model="regForm"
            :rules="rules"
            ref="regForm"
            class="demo-ruleForm"
          >
            <el-form-item
              label="æ˜µç§°"
              label-width="80px"
              style="margin-bottom: 20px"
              prop="regnickname"
            >
              <el-input v-model="regForm.regnickname"></el-input>
            </el-form-item>
            <el-form-item
              label="è´¦å·"
              label-width="80px"
              style="margin-bottom: 20px"
              prop="reguid"
            >
              <el-input v-model="regForm.reguid"></el-input>
            </el-form-item>
            <el-form-item
              label="å¯†ç "
              label-width="80px"
              style="margin-bottom: 20px"
              prop="regpass"
            >
              <el-input
                v-model="regForm.regpass"
                show-password
                autocomplete="off"
              ></el-input>
            </el-form-item>
            <el-form-item
              label="å¯†ç "
              label-width="80px"
              style="margin-bottom: 20px"
              prop="checkPass"
            >
              <el-input
                v-model="regForm.checkPass"
                show-password
                autocomplete="off"
              ></el-input>
            </el-form-item>
            <el-form-item
              label="é‚®ç®±"
              label-width="80px"
              style="margin-bottom: 20px"
              prop="regemail"
            >
              <el-input v-model="regForm.regemail">
                <el-button slot="append" @click="sendRegisterCode"
                  >è·å–éªŒè¯ç </el-button
                >
              </el-input>
            </el-form-item>
            <el-form-item
              label="éªŒè¯ç "
              label-width="80px"
              style="margin-bottom: 20px"
            >
              <el-input v-model="regForm.code"></el-input>
            </el-form-item>
            <el-form-item>
              <el-button type="primary" @click="regist">æ³¨å†Œ</el-button>
              <el-button @click="dialogRegistVisible = false">å–æ¶ˆ</el-button>
            </el-form-item>
          </el-form>
        </el-dialog>
        <el-dialog
          title="åœ°å€é€‰æ‹©å™¨"
          :visible.sync="dialogAddressVisible"
          width="400px"
        >
          <v-distpicker
            @province="selectProvince"
            @city="selectCity"
            @area="selectDist"
          ></v-distpicker>
          <el-divider></el-divider>
          <el-button type @click="saveaddress">ç¡®è®¤</el-button>
          <el-button type @click="dialogAddressVisible = false">å–æ¶ˆ</el-button>
        </el-dialog>
        <el-dialog
          title="æ·»åŠ å¥½å‹"
          :visible.sync="dialogAddFriendVisible"
          width="400px"
        >
          <el-form>
            <el-form-item label="è´¦å·" label-width="60px">
              <el-input v-model="addFriendUid" placeholder>
                <el-button slot="append" @click="selectUser">æŸ¥è¯¢</el-button>
              </el-input>
              <el-card
                v-if="selectUserInfo.uid"
                style="height: 146px; margin-top: 8px"
              >
                <div class="flex">
                  <div>
                    <el-avatar
                      shape="square"
                      :size="44"
                      :src="selectUserInfo.headimg"
                    ></el-avatar>
                  </div>
                  <div style="margin-left: 14px">
                    <div style="line-height: 14px">
                      {{ selectUserInfo.nickname }}
                    </div>
                    <div
                      style="
                        font-size: 12px;
                        color: #696969;
                        margin-top: 12px;
                        line-height: 14px;
                      "
                    >
                      {{ selectUserInfo.signature }}
                    </div>
                  </div>
                </div>
                <el-button style="margin-top: 10px" @click="addFriend"
                  >ç”³è¯·å¥½å‹</el-button
                >
              </el-card>
            </el-form-item>
          </el-form>
        </el-dialog>
        <div
          id="menu"
          class="menu"
          v-show="menuVisible"
          style="
            position: absolute;
            z-index: 99999;
            background-color: #ffffff;
            font-size: 12px;
            border: 1px;
            border-style: solid;
            border-color: #e0e0e0;
          "
        >
          <el-button @click="removeMessage">åˆ é™¤</el-button>
        </div>
      </el-row>
    </el-main>
  </el-container>
</template>
<style>
</style>
<script>
import axios from 'axios'
import VDistpicker from 'v-distpicker'
export default {
  components: { VDistpicker },
  data () {
    var validatePass = (rule, value, callback) => {
      if (value.length < 8) {
        callback(new Error('å¯†ç é•¿åº¦åº”å¤§äº 8 ä½'))
      } else if (this.ruleForm.checkPass !== value) {
        callback(new Error('ä¸¤æ¬¡è¾“å…¥å¯†ç ä¸ä¸€è‡´!'))
      } else {
        callback()
      }
    }
    var validatePass2 = (rule, value, callback) => {
      if (value.length < 8) {
        callback(new Error('è¯·å†æ¬¡è¾“å…¥å¯†ç '))
      } else if (value !== this.regForm.regpass) {
        callback(new Error('ä¸¤æ¬¡è¾“å…¥å¯†ç ä¸ä¸€è‡´!'))
      } else {
        callback()
      }
    }
    var validateEmail = (rulem, value, callback) => {
      let email = /^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/
      if (!email.test(value)) {
        callback(new Error('è¯·è¾“å…¥æ­£ç¡®çš„é‚®ç®±å·ç '))
      } else {
        callback()
      }
    }
    return {
      // æ˜ŸæœŸ
      emoji: [
        'ğŸ˜€',
        'ğŸ˜',
        'ğŸ˜‚',
        'ğŸ˜ƒ',
        'ğŸ˜„',
        'ğŸ˜…',
        'ğŸ˜†',
        'ğŸ˜‰',
        'ğŸ˜Š',
        'ğŸ˜‹',
        'ğŸ˜',
        'ğŸ˜',
        'ğŸ˜˜',
        'ğŸ˜—',
        'ğŸ˜™',
        'ğŸ˜š',
        'ğŸ˜‡',
        'ğŸ˜',
        'ğŸ˜‘',
        'ğŸ˜¶',
        'ğŸ˜',
        'ğŸ˜£',
        'ğŸ˜¥',
        'ğŸ˜®',
        'ğŸ˜¯',
        'ğŸ˜ª',
        'ğŸ˜«',
        'ğŸ˜´',
        'ğŸ˜Œ',
        'ğŸ˜›',
        'ğŸ˜œ',
        'ğŸ˜',
        'ğŸ˜’',
        'ğŸ˜“',
        'ğŸ˜”',
        'ğŸ˜•',
        'ğŸ˜²',
        'ğŸ˜·',
        'ğŸ˜–',
        'ğŸ˜',
        'ğŸ˜Ÿ',
        'ğŸ˜¤',
        'ğŸ˜¢',
        'ğŸ˜­',
        'ğŸ˜¦',
        'ğŸ˜§',
        'ğŸ˜¨',
        'ğŸ˜¬',
        'ğŸ˜°',
        'ğŸ˜±',
        'ğŸ˜³',
        'ğŸ˜µ',
        'ğŸ˜¡',
        'ğŸ˜ '
      ],
      week: [
        'æ˜ŸæœŸå¤©',
        'æ˜ŸæœŸä¸€',
        'æ˜ŸæœŸäºŒ',
        'æ˜ŸæœŸä¸‰',
        'æ˜ŸæœŸå››',
        'æ˜ŸæœŸäº”',
        'æ˜ŸæœŸå…­'
      ],
      // åœ°å€é€‰æ‹©å™¨å‚æ•°
      address: {
        province: '',
        city: '',
        dist: ''
      },
      // è¯·æ±‚å¤´éƒ¨
      headers: {
        token: '',
        userid: ''
      },
      // è¦æ·»åŠ çš„å¥½å‹è´¦å·
      addFriendUid: '',
      selectUserInfo: '',
      // å¥½å‹ä¿¡æ¯
      info: {},
      // å¥½å‹åˆ—è¡¨
      friendList: [],
      // æ¶ˆæ¯åˆ—è¡¨
      messageList: [],
      removeMessageUid: '',
      // å½“å‰èŠå¤©åˆ—è¡¨
      nowmessagelist: [],
      // å½“å‰èŠå¤©å¯¹è±¡
      nowmessagefriend: [],
      // èŠå¤©è¾“å…¥æ¡†
      sendmessage: '',
      // æ§åˆ¶åˆ—è¡¨æ˜¾ç¤º
      showList: 'index',
      // æ§åˆ¶çª—å£æ˜¾ç¤º
      showBox: 'message',
      key: '',
      // ç™»å½•å¼¹çª—æ§åˆ¶
      dialogLoginVisible: false,
      // æ³¨å†Œå¼¹çª—æ§åˆ¶
      dialogRegistVisible: false,
      // åœ°å€é€‰æ‹©å™¨å¼¹çª—æ§åˆ¶
      dialogAddressVisible: false,
      // æ·»åŠ å¥½å‹å¼¹çª—æ§åˆ¶
      dialogAddFriendVisible: false,
      menuVisible: false,
      // ç”¨æˆ·å
      username: '',
      // å¯†ç 
      password: '',
      // ç”¨æˆ·ä¿¡æ¯
      userinfo: '',
      // ä¸ªäººä¿¡æ¯ ä¿®æ”¹
      myselfinfo: '',
      // token
      usertoken: '',
      //  websocketå¯¹è±¡
      path: 'ws://47.94.109.216:8282',
      ws: '',
      // æ³¨å†Œ
      regForm: {
        regnickname: '',
        reguid: '',
        regpass: '',
        checkPass: '',
        regemail: '',
        code: ''
      },
      rules: {
        regnickname: [
          { required: true, message: 'è¯·è¾“å…¥æ˜µç§°', trigger: 'blur' },
          { max: 18, message: 'é•¿åº¦åº”å°äº 18 ä¸ªå­—ç¬¦', trigger: 'blur' }
        ],
        reguid: [
          { required: true, message: 'è¯·è¾“å…¥è´¦å·', trigger: 'blur' },
          {
            min: 6,
            max: 18,
            message: 'é•¿åº¦åœ¨ 6 åˆ° 16 ä¸ªå­—ç¬¦',
            trigger: 'blur'
          }
        ],
        regpass: [{ validator: validatePass, trigger: 'blur' }],
        checkPass: [{ validator: validatePass2, trigger: 'blur' }],
        regemail: [{ validator: validateEmail, trigger: 'blur' }]
      }
    }
  },
  methods: {
    /**
     * websocket ç›¸å…³æ“ä½œ
     * init åˆå§‹åŒ–
     * onopen è¿æ¥æˆåŠŸäº‹ä»¶
     * onerror è¿æ¥å¤±è´¥äº‹ä»¶
     * onmessage ç›‘å¬äº‹ä»¶
     */
    init () {
      var that = this
      if (typeof WebSocket === 'undefined') {
        alert('æµè§ˆå™¨ä¸æ”¯æŒ')
      } else {
        that.ws = new WebSocket(that.path)
        that.ws.onopen = that.onopen
        that.ws.operror = that.onerror
        that.ws.onmessage = that.onmessage
      }
    },
    onopen () {
      console.log('è¿æ¥æˆåŠŸ')
    },
    onerror () {
      console.log('è¿æ¥é”™è¯¯')
    },
    onmessage (msg) {
      let that = this
      let re = JSON.parse(msg.data)
      if (re.fuid === 'success') {
        console.log(re.message)
      } else if (re.fuid === 'error') {
        console.log(re.message)
      } else {
        if (re.fuid === that.nowmessagefriend.fuid) {
          that.nowmessagelist.push({
            status: 0,
            body: re.message,
            chattime: re.chattime
          })
          that.$nextTick(() => {
            that.$refs.main1.scrollTop = that.$refs.main1.scrollHeight
          })
        }
        if (that.showList === 'message') {
          that.updateMessageList()
        }
      }
    },
    // ç™»å½•
    login () {
      var that = this
      axios
        .get('http://api.25cl.cn/project/chat/login', {
          params: {
            username: that.username,
            password: that.password
          }
        })
        .then((res) => {
          if (res.data) {
            that.dialogLoginVisible = false
            that.userinfo = res.data.userinfo
            that.headers.token = res.data.token
            that.headers.userid = that.username
            that.ws.send('{"code":"login","uid":"' + that.username + '"}')
            that.$message({
              message: 'ç™»å½•æˆåŠŸ',
              type: 'success'
            })
            console.log(that.userinfo)
          } else {
            console.log('false')
            that.$message({
              message: 'ç™»å½•å¤±è´¥',
              type: 'error'
            })
          }
        })
    },
    // æ³¨å†Œ
    regist () {
      let that = this
      let params = new URLSearchParams()
      params.append('reguid', that.regForm.reguid)
      params.append('regpassword', that.regForm.regpass)
      params.append('regpassword1', that.regForm.checkPass)
      params.append('regnickname', that.regForm.regnickname)
      params.append('regemail', that.regForm.regemail)
      params.append('regcode', that.regForm.code)
      console.log(params)
      axios.post('http://api.25cl.cn/project/chat/register', params)
    },
    // æ˜¾ç¤ºå¥½å‹åˆ—è¡¨
    showFriendList () {
      this.showList = 'friend'
      this.updateFriendList()
    },
    // æ›´æ–°å¥½å‹åˆ—è¡¨
    updateFriendList () {
      let that = this
      console.log('update')
      axios
        .get('http://api.25cl.cn/project/chat/updateShow', {
          params: {
            status: 'friendlist'
          },
          headers: that.headers
        })
        .then((res) => {
          console.log(res)
          that.friendList = res.data
        })
    },
    // æ˜¾ç¤ºèŠå¤©åˆ—è¡¨
    showMessageList () {
      this.showList = 'message'
      this.updateMessageList()
    },
    // ç§»å‡ºèŠå¤©åˆ—è¡¨
    removeMessage () {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/friendcommand', {
          params: {
            command: 'removeMessage',
            fuid: that.removeMessageUid
          },
          headers: that.headers
        })
        .then((res) => {
          that.showMessageList()
        })
    },
    // æ›´æ–°èŠå¤©åˆ—è¡¨
    updateMessageList () {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/updateShow', {
          params: {
            status: 'chatlist'
          },
          headers: that.headers
        })
        .then((res) => {
          console.log(res)
          that.messageList = res.data
        })
    },
    // å‘é€ä¿¡æ¯æŒ‰é’®è·³è½¬è‡³èŠå¤©çª—å£
    goMessageBox () {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/friendcommand', {
          params: {
            fuid: that.info.fuid,
            command: 'addchatlist'
          },
          headers: that.headers
        })
        .then((res) => {
          that.openMessage(that.info)
          that.showMessageList()
        })
    },
    // è·å–éªŒè¯ç 
    sendRegisterCode () {
      let that = this
      let params = new URLSearchParams()
      params.append('email', that.regForm.regemail)
      console.log(params)
      axios.post('http://api.25cl.cn/project/chat/addRegisterCode', params)
    },
    // æŸ¥è¯¢ç”¨æˆ·
    selectUser () {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/selectUser', {
          params: {
            selectUser: that.addFriendUid
          },
          headers: that.headers
        })
        .then((res) => {
          that.selectUserInfo = res.data
        })
      console.log(that.selectUserInfo)
    },
    // æ·»åŠ å¥½å‹
    addFriend () {
      let that = this
      axios.get('http://api.25cl.cn/project/chat/addFriend', {
        params: {
          fuid: that.selectUserInfo.uid,
          time: Date.parse(new Date()) / 100
        },
        headers: that.headers
      })
    },
    // å¥½å‹ç›¸å…³æ“ä½œ
    friendCommand (command) {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/friendcommand', {
          params: {
            fuid: that.info.fuid,
            command: command
          },
          headers: that.headers
        })
        .then((res) => {
          if (that.showList === 'friend') {
            that.updateFriendList()
          }
          if (command === 'onblacklist') {
            that.info.relation = 0
          } else if (command === 'offblacklist') {
            that.info.relation = 1
          } else if (command === 'agree') {
            that.info.relation = 1
          }
        })
    },
    // æ‰“å¼€æ¶ˆæ¯çª—å£
    openMessage (item) {
      let that = this
      that.nowmessagelist = []
      that.updateMessage(item.fuid, new Date().valueOf(), 0)
      that.nowmessagefriend = item
      console.log(item)
      that.sendmessage = ''
      that.showBox = 'message'
    },
    // æ›´æ–°æ¶ˆæ¯
    updateMessage (fuid, chattime, status) {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/selectMessage', {
          params: {
            fuid: fuid,
            chattime: chattime,
            status: status
          },
          headers: that.headers
        })
        .then((res) => {
          console.log(res)
          let arr = res.data.reverse()
          for (let index = 0; index < arr.length; index++) {
            that.nowmessagelist.push(arr[index])
            that.$nextTick(() => {
              that.$refs.main1.scrollTop = that.$refs.main1.scrollHeight
            })
          }
        })
    },
    // å‘é€æ¶ˆæ¯
    sendMessage () {
      let that = this
      let mtime = Date.now()
      that.nowmessagelist.push({
        status: 1,
        body: that.sendmessage,
        chattime: mtime
      })
      console.log(that.nowmessagelist)
      console.log(
        '{"code":"send","fuid":"' +
          that.nowmessagefriend.fuid +
          '","message":"' +
          that.sendmessage +
          '","time":"' +
          mtime +
          '"}'
      )
      that.ws.send(
        '{"code":"send","fuid":"' +
          that.nowmessagefriend.fuid +
          '","message":"' +
          that.sendmessage +
          '","time":"' +
          mtime +
          '"}'
      )
      that.sendmessage = ''
      that.$nextTick(() => {
        that.$refs.main1.scrollTop = that.$refs.main1.scrollHeight
      })
      that.updateMessageList()
    },
    // æ›´æ–°å¥½å‹å¤‡æ³¨
    updateFriendNote (event) {
      let that = this
      that.info.notes = event.currentTarget.value
      console.log(event.currentTarget.value)
      axios
        .get('http://api.25cl.cn/project/chat/updatefriendnote', {
          params: {
            fuid: that.info.fuid,
            notes: event.currentTarget.value
          },
          headers: that.headers
        })
        .then((res) => {
          that.updateFriendList()
        })
    },
    // æ˜¾ç¤ºå¥½å‹ä¿¡æ¯
    showFriendInfo (item) {
      this.showBox = 'info'
      this.info = ''
      this.info = item
      console.log(item)
    },
    // æ˜¾ç¤ºè‡ªå·±ä¿¡æ¯
    showmyself () {
      console.log(this.userinfo)
      this.myselfinfo = { ...this.userinfo }
      this.showBox = 'myself'
    },
    // æ›´æ–°è‡ªå·±ä¿¡æ¯
    updateMyself () {
      let that = this
      console.log(that.myselfinfo)
      axios
        .get('http://api.25cl.cn/project/chat/savemyselfinfo', {
          params: {
            nickname: that.myselfinfo.nickname,
            sex: that.myselfinfo.sex,
            birthday: that.myselfinfo.birthday,
            signature: that.myselfinfo.signature,
            address: that.myselfinfo.address
          },
          headers: that.headers
        })
        .then((res) => {
          that.userinfo = res.data
        })
    },
    // ä¿å­˜åœ°å€
    saveaddress () {
      let that = this
      console.log(that.userinfo)
      that.myselfinfo.address =
        (that.address.province === that.address.city
          ? that.address.province
          : that.address.province + ' ' + that.address.city) +
        ' ' +
        that.address.dist
      console.log(that.myselfinfo)
      that.dialogAddressVisible = false
    },
    // åœ°å€é€‰æ‹©å™¨--çœ
    selectProvince (e) {
      if (e.value.length > 2) {
        this.address.province = e.value
      } else {
        this.address.province = ''
      }
    },
    // åœ°å€é€‰æ‹©å™¨--å¸‚
    selectCity (e) {
      if (e.value.length > 2) {
        this.address.city = e.value
      } else {
        this.address.city = ''
      }
    },
    // åœ°å€é€‰æ‹©å™¨--åŒº
    selectDist (e) {
      if (e.value.length > 2) {
        this.address.dist = e.value
      } else {
        this.address.dist = ''
      }
    },
    handleAvatarSuccess (res, file) {
      this.myselfinfo.headimg = URL.createObjectURL(file.raw)
      this.userinfo.headimg = URL.createObjectURL(file.raw)
    },
    beforeAvatarUpload (file) {
      const isJPG = file.type === 'image/jpeg'
      const isLt2M = file.size / 1024 / 1024 < 2

      if (!isJPG) {
        this.$message.error('ä¸Šä¼ å¤´åƒå›¾ç‰‡åªèƒ½æ˜¯ JPG æ ¼å¼!')
      }
      if (!isLt2M) {
        this.$message.error('ä¸Šä¼ å¤´åƒå›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 2MB!')
      }
      return isJPG && isLt2M
    },
    inputemoji (item) {
      this.sendmessage += item
      console.log(this.sendmessage)
    },
    rightClick (uid) {
      // é¼ æ ‡å³å‡»è§¦å‘äº‹
      event.preventDefault()
      this.menuVisible = false // å…ˆæŠŠæ¨¡æ€æ¡†å…³æ­»ï¼Œç›®çš„æ˜¯ ç¬¬äºŒæ¬¡æˆ–è€…ç¬¬næ¬¡å³é”®é¼ æ ‡çš„æ—¶å€™ å®ƒé»˜è®¤çš„æ˜¯true
      this.menuVisible = true // æ˜¾ç¤ºæ¨¡æ€çª—å£ï¼Œè·³å‡ºè‡ªå®šä¹‰èœå•æ 
      var menu = document.querySelector('#menu')
      menu.style.left = event.clientX + 5 + 'px'
      document.addEventListener('click', this.foo) // ç»™æ•´ä¸ªdocumentæ·»åŠ ç›‘å¬é¼ æ ‡äº‹ä»¶ï¼Œç‚¹å‡»ä»»ä½•ä½ç½®æ‰§è¡Œfooæ–¹æ³•
      menu.style.top = event.clientY - 80 + 'px'
      console.log(uid)
      this.removeMessageUid = uid
    },

    foo () {
      // å–æ¶ˆé¼ æ ‡ç›‘å¬äº‹ä»¶ èœå•æ 
      this.menuVisible = false

      document.removeEventListener('click', this.foo) // è¦åŠæ—¶å…³æ‰ç›‘å¬ï¼Œä¸å…³æ‰çš„æ˜¯ä¸€ä¸ªå‘ï¼Œä¸ä¿¡ä½ è¯•è¯•ï¼Œè™½ç„¶å‰å°æ˜¾ç¤ºçš„æ—¶å€™æ²¡æœ‰å•¥æ¯›ç—…ï¼ŒåŠ ä¸€ä¸ªalertä½ å°±çŸ¥é“äº†
    },
    chattimeFormatter (value) {
      console.log(value)
      var date = new Date(parseInt(value)) // æ—¶é—´æˆ³ä¸º10ä½éœ€*1000ï¼Œæ—¶é—´æˆ³ä¸º13ä½çš„è¯ä¸éœ€ä¹˜1000
      console.log(date)
      let y = date.getYear()
      let M = date.getMonth() + 1
      let d = date.getDate()
      let week = date.getDay()
      let h = date.getHours()
      let m = date.getMinutes()
      var nowDate = new Date()
      let nowy = nowDate.getYear()
      let nowM = nowDate.getMonth() + 1
      let nowd = nowDate.getDate()
      let nowweek = nowDate.getDay()
      if (nowy === y && nowM === M) {
        if (nowd === d) {
          return h + ':' + (m < 10 ? '0' + m : m)
        } else if (nowd - 1 === d) {
          return 'æ˜¨å¤©'
        } else if (nowd - nowweek <= d) {
          return this.week[week]
        } else {
          return (y + '').substr(1, 2) + '/' + M + '/' + d
        }
      } else {
        return (y + '').substr(1, 2) + '/' + M + '/' + d
      }
    }
  },
  mounted () {
    this.init()
  }
}
</script>
