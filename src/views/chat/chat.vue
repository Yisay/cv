<template>
  <el-container style="height: 100%">
    <el-header>
      <el-menu default-active="" :router="true">
        <el-menu-item
          index="/"
          style="
            width: 120px;
            height: 20px;
            background-color: #00000050;
            line-height: 20px;
          "
          >ËøîÂõû‰∏ªÈ°µ</el-menu-item>
      </el-menu>
      </el-header>
    <el-main>
      <el-row class="fillheight">
        <el-col :span="6"
          ><el-collapse v-model="activeName" accordion>
            <el-collapse-item title="ÂÆûÁé∞ÂäüËÉΩ" name="1">
              <ul>
                <li>ÁôªÂΩï</li>
                <li>Ê≥®ÂÜå</li>
                <li>Ê∑ªÂä†Â•ΩÂèã</li>
                <li>‰øÆÊîπ‰∏™‰∫∫‰ø°ÊÅØ</li>
                <li>‰øÆÊîπÂ•ΩÂèãÂ§áÊ≥®</li>
                <li>Âç≥Êó∂ËÅäÂ§©(Âú®Á∫øËÅäÂ§©ÔºåÁ¶ªÁ∫ø‰ø°ÊÅØÔºåÂèëÈÄÅemoji)</li>
                <li>Ê∑ªÂä†ÊãâÈªëÂà†Èô§Â•ΩÂèãÊìç‰Ωú</li>
              </ul>
            </el-collapse-item>
            <el-collapse-item title="Ê°ÜÊû∂" name="2">
              <ul>
                <li>ÂâçÁ´ØÔºövue+element</li>
                <li>ÂêéÁ´ØÔºöthinkphp5+workerman</li>
                <li>Êï∞ÊçÆÂ∫ìÔºömysql</li>
                <li>thinkphp5(ÈÄªËæëÈÉ®ÂàÜ)</li>
                <li>workerman(ÈÄöËÆØÈÉ®ÂàÜ)</li>
              </ul>
            </el-collapse-item>
          </el-collapse></el-col
        >
        <!--‰∏ªÁïåÈù¢-->
        <el-col :span="12" class="fillheight" style="max-height: 600px">
          <el-row class="fillheight">
            <!--Â∑¶‰æßËèúÂçïÊ†è-->
            <el-col
              :span="2"
              class="fillheight"
              style="
                background: #2b2b2b;
                border-top-left-radius: 4px;
                border-bottom-left-radius: 4px;
              "
            >
              <div
                class="flex fillheight"
                style="flex-direction: column; justify-content: space-between"
              >
                <!--Â∑¶‰æß‰∏äÈÉ®-->
                <div>
                  <!--Â§¥ÂÉè-->
                  <div @click="showmyself()">
                    <el-avatar
                      class="aligncenter"
                      :size="40"
                      shape="square"
                      style="margin-top: 20px; margin-bottom: 20px"
                      :src="userinfo.headimg"
                    />
                  </div>
                  <!--‰ø°ÊÅØ-->
                  <div
                    class="el-icon-chat-round aligncenter"
                    style="
                      width: 26px;
                      line-height: 40px;
                      font-size: 26px;
                      color: #484b4e;
                    "
                    @click="showMessageList"
                  ></div>
                  <!--Â•ΩÂèã-->
                  <div
                    class="el-icon-notebook-1 aligncenter"
                    style="
                      width: 26px;
                      line-height: 40px;
                      font-size: 26px;
                      color: #484b4e;
                    "
                    @click="showFriendList"
                  ></div>
                </div>
                <!--Â∑¶‰æß‰∏ãÈÉ®-->
                <div>
                  <el-popover
                    placement="right-end"
                    width="100"
                    trigger="click"
                    style="padding: 0px"
                    visible-arrow="false"
                  >
                    <el-menu
                      style="width: 100px"
                      active-text-color="#2f3032"
                      background-color="#2b2b2a"
                      text-color="#8c8c8c"
                    >
                      <el-menu-item @click="dialogLoginVisible = true"
                        >ÁôªÂΩï</el-menu-item
                      >
                      <el-menu-item @click="dialogRegistVisible = true"
                        >Ê≥®ÂÜå</el-menu-item
                      >
                      <el-menu-item @click="dialogAddFriendVisible = true"
                        >Ê∑ªÂä†Â•ΩÂèã</el-menu-item
                      >
                      <!--<el-menu-item @click="dialogSettingVisible = true">ËÆæÁΩÆ</el-menu-item>
                      <el-menu-item @click="dialogAddressVisible = true">Ê≥®ÈîÄ</el-menu-item>-->
                    </el-menu>
                    <div
                      class="el-icon-more-outline aligncenter"
                      slot="reference"
                      style="
                        width: 26px;
                        line-height: 50px;
                        font-size: 26px;
                        color: #484b4e;
                      "
                    ></div>
                  </el-popover>
                </div>
              </div>
            </el-col>
            <!---->
            <!--‰∏≠Èó¥ÂàóË°®Âàó-->
            <el-col :span="8" style="background: #eae8e7" class="fillheight">
              <!--ÊêúÁ¥¢Ê†è-->
              <div class="flex" style="padding: 20px 10px">
                <!--ËæìÂÖ•Ê°Ü-->
                <div class="el-input el-input--mini el-input--prefix">
                  <input
                    type="text"
                    autocomplete="off"
                    placeholder="ÊêúÁ¥¢"
                    class="el-input__inner"
                    style="background: #dbd9d8"
                  />
                  <span class="el-input__prefix">
                    <i
                      class="el-input__icon el-icon-search"
                      style="color: #818181"
                    ></i>
                  </span>
                </div>
                <!--Ê∑ªÂä†ÊåâÈíÆ-->
                <el-button
                  icon="el-icon-plus"
                  size="mini"
                  style="padding: 6px; margin-left: 10px; background: #dbd9d8"
                ></el-button>
              </div>
              <!--Â•ΩÂèãÂàóË°®-->
              <div
                v-if="showList == 'friend'"
                class="scroll_config"
                style="overflow-y: scroll; height: 85%"
              >
                <el-collapse>
                  <el-collapse-item name="1">
                    <template slot="title">
                      <i
                        class="el-icon-circle-close"
                        style="
                          color: #fff;
                          background-color: #a0a0a0;
                          font-size: 28px;
                          border-radius: 4px;
                          margin: 12px;
                          padding: 4px;
                        "
                      />ÈªëÂêçÂçï
                    </template>
                    <div
                      v-for="(item, index) in friendList"
                      :key="index"
                      @click="showFriendInfo(item)"
                    >
                      <div v-if="item.relation == 0" class="flex list-link">
                        <div style="margin: 12px; width: 36px; height: 36px">
                          <el-avatar
                            shape="square"
                            :size="36"
                            :src="item.headimg"
                          ></el-avatar>
                        </div>
                        <!--ÊòµÁß∞/Â§áÊ≥®-->
                        <div
                          style="
                            padding-top: 20px;
                            font-size: 14px;
                            overflow: hidden;
                            white-space: nowrap;
                            text-overflow: ellipsis;
                          "
                        >
                          {{ item.notes == "" ? item.nickname : item.notes }}
                        </div>
                      </div>
                    </div>
                    <!--Â§¥ÂÉè-->
                  </el-collapse-item>
                  <el-collapse-item name="2">
                    <template slot="title">
                      <i
                        class="el-icon-circle-plus-outline"
                        style="
                          color: #fff;
                          background-color: #ffa020;
                          font-size: 28px;
                          border-radius: 4px;
                          margin: 12px;
                          padding: 4px;
                        "
                      />Â•ΩÂèãËØ∑Ê±Ç
                    </template>
                    <div
                      v-for="(item, index) in friendList"
                      :key="index"
                      @click="showFriendInfo(item)"
                    >
                      <div v-if="item.relation == 2" class="flex list-link">
                        <div style="margin: 12px; width: 36px; height: 36px">
                          <el-avatar
                            shape="square"
                            :size="36"
                            :src="item.headimg"
                          ></el-avatar>
                        </div>
                        <!--ÊòµÁß∞/Â§áÊ≥®-->
                        <div
                          style="
                            padding-top: 20px;
                            font-size: 14px;
                            overflow: hidden;
                            white-space: nowrap;
                            text-overflow: ellipsis;
                          "
                        >
                          {{ item.notes == "" ? item.nickname : item.notes }}
                        </div>
                      </div>
                    </div>
                  </el-collapse-item>
                </el-collapse>
                <!--Âæ™ÁéØËµãÂÄº-->
                <div
                  v-for="(item, index) in friendList"
                  :key="index"
                  @click="showFriendInfo(item)"
                >
                  <div v-if="item.relation == 1" class="flex list-link">
                    <div style="margin: 12px; width: 36px; height: 36px">
                      <el-avatar
                        shape="square"
                        :size="36"
                        :src="item.headimg"
                      ></el-avatar>
                    </div>
                    <!--ÊòµÁß∞/Â§áÊ≥®-->
                    <div
                      style="
                        padding-top: 20px;
                        font-size: 14px;
                        overflow: hidden;
                        white-space: nowrap;
                        text-overflow: ellipsis;
                      "
                    >
                      {{ item.notes == "" ? item.nickname : item.notes }}
                    </div>
                  </div>
                </div>
              </div>
              <!--Ê∂àÊÅØÂàóË°®-->
              <div
                v-if="showList == 'message'"
                class="scroll_config"
                style="overflow-y: scroll; height: 85%"
              >
                <div
                  v-for="(item, index) in messageList"
                  :key="index"
                  class="flex list-link"
                  @click="openMessage(item)"
                  @contextmenu.prevent="rightClick(item.fuid)"
                >
                  <!--Ê∂àÊÅØbadge„ÄÅÂ§¥ÂÉè-->
                  <div style="margin: 12px">
                    <el-badge
                      v-if="item.newmessage > 0"
                      :value="item.newmessage"
                      class="item"
                    >
                      <el-avatar
                        shape="square"
                        :size="36"
                        :src="item.headimg"
                      ></el-avatar>
                    </el-badge>
                    <el-avatar
                      v-else
                      shape="square"
                      :size="36"
                      :src="item.headimg"
                    ></el-avatar>
                  </div>
                  <div style="width: 100%">
                    <!--Âè≥‰∏äÈÉ®ÂàÜ-->
                    <div
                      class="flex"
                      style="
                        width: 100%;
                        justify-content: flex-end;
                        padding-top: 10px;
                      "
                    >
                      <!--ÊòµÁß∞/Â§áÊ≥®-->
                      <div style="flex: 1; font-size: 12px">
                        <div
                          style="
                            width: 90%;
                            text-overflow: ellipsis;
                            overflow: hidden;
                            white-space: nowrap;
                          "
                        >
                          {{ item.notes == "" ? item.nickname : item.notes }}
                        </div>
                      </div>
                      <!--ÊúÄËøë‰∏ÄÊù°‰ø°ÊÅØÊó∂Èó¥-->
                      <div
                        class="c696969"
                        style="width: 70px; margin-left: 4px; font-size: 10px"
                      >
                        {{
                          item.chattime !== null
                            ? chattimeFormatter(item.chattime)
                            : ""
                        }}
                      </div>
                    </div>
                    <!--ÊúÄËøë‰∏ÄÊù°Ê∂àÊÅØ-->
                    <div
                      class="c696969"
                      style="
                        width: 180px;
                        font-size: 12px;
                        overflow: hidden;
                        white-space: nowrap;
                        text-overflow: ellipsis;
                        line-height: 24px;
                      "
                    >
                      {{ item.body }}
                    </div>
                  </div>
                </div>
              </div>
            </el-col>
            <!--Âè≥‰æßËØ¶ÁªÜÁ™óÂè£Âàó-->
            <el-col :span="14" style="background: #f5f5f5" class="fillheight">
              <!--Â¶ÇÂàùÂßãÂåñÂàó-->
              <div
                v-if="showBox == 'index'"
                style="
                  margin-top: 120px;
                  line-height: 14px;
                  font-size: 14px;
                  word-space: 0px;
                  letter-spacing: 0px;
                "
              >
                <div>
                  &nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__
                </div>
                <div>
                  &nbsp;/\&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;/\&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\&nbsp;\
                </div>
                <div>
                  &nbsp;\&nbsp;\&nbsp;\___&nbsp;&nbsp;&nbsp;__&nbsp;\&nbsp;\&nbsp;&nbsp;\&nbsp;&nbsp;\&nbsp;\&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_____&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_______&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;_&nbsp;&nbsp;\_\&nbsp;\
                </div>
                <div>
                  &nbsp;&nbsp;\&nbsp;\&nbsp;&nbsp;_&nbsp;`\/\&nbsp;_&nbsp;`\&nbsp;\&nbsp;&nbsp;\&nbsp;&nbsp;\&nbsp;\&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;/\&nbsp;&nbsp;___\/\&nbsp;&nbsp;\&nbsp;&nbsp;/\&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;/\&nbsp;&nbsp;__`\/\&nbsp;\/&nbsp;`\/'_`&nbsp;&nbsp;\
                </div>
                <div>
                  &nbsp;&nbsp;&nbsp;\&nbsp;\&nbsp;\/\&nbsp;\&nbsp;\&nbsp;_&nbsp;/\&nbsp;\&nbsp;&nbsp;\_\&nbsp;\&nbsp;&nbsp;\_&nbsp;\&nbsp;\&nbsp;\L\&nbsp;\&nbsp;\&nbsp;&nbsp;\/&nbsp;&nbsp;\/&nbsp;&nbsp;/\&nbsp;\&nbsp;\L\&nbsp;\&nbsp;\&nbsp;&nbsp;/\/\&nbsp;\L\&nbsp;\
                </div>
                <div>
                  &nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;\_\&nbsp;\_\&nbsp;\__/\&nbsp;\&nbsp;___\&nbsp;\___&nbsp;\&nbsp;\&nbsp;&nbsp;___\&nbsp;\__/\__/&nbsp;&nbsp;&nbsp;\&nbsp;\____\&nbsp;\_\&nbsp;\&nbsp;\___,_\
                </div>
                <div>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/_/\/_/\/__/&nbsp;\/___/\/___/&nbsp;\/___/&nbsp;\/_/\/_/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/___/\/_/&nbsp;&nbsp;\/__,_&nbsp;/
                </div>
              </div>
              <!--Â¶ÇÂ•ΩÂèãËµÑÊñôÂàó-->
              <div v-if="showBox == 'info'" style="padding: 60px">
                <div class="flex">
                  <div>
                    <el-avatar
                      shape="square"
                      :size="80"
                      :src="info.headimg"
                    ></el-avatar>
                  </div>
                  <div style="margin-left: 20px">
                    <div>{{ info.nickname }}</div>
                    <div
                      style="font-size: 12px; color: #696969; margin-top: 16px"
                    >
                      {{ info.signature }}
                    </div>
                  </div>
                </div>
                <el-divider></el-divider>
                <div>
                  <div class="flex lh40">
                    <span class="w50 c696969" style>Â§áÊ≥®Ôºö</span>
                    <input
                      class="inputupdate"
                      style="
                        padding: 0;
                        border: 0;
                        height: 38px;
                        font-size: 16px;
                        background: #ffffff00;
                      "
                      :value="info.notes"
                      @change="updateFriendNote($event)"
                    />
                  </div>
                  <div class="flex lh40">
                    <span class="w50 c696969">Âú∞ÂùÄÔºö</span>
                    <div>
                      <span>{{ info.address }}</span>
                    </div>
                  </div>
                  <div class="flex lh40">
                    <span class="w50 c696969">Ë¥¶Âè∑Ôºö</span>
                    <span>{{ info.fuid }}</span>
                  </div>
                  <div class="flex lh40">
                    <span class="w50 c696969">ÊÄßÂà´Ôºö</span>
                    <div class="lh40">
                      <img
                        v-if="info.sex == 0"
                        src="http://api.25cl.cn/static/img/0.png"
                        style="width: 16px; height: 16px; padding-top: 12px"
                      />
                      <img
                        v-else
                        src="http://api.25cl.cn/static/img/1.png"
                        style="width: 16px; height: 16px; padding-top: 12px"
                      />
                    </div>
                  </div>
                </div>
                <el-divider></el-divider>
                <div v-if="info.relation < 2">
                  <el-button type="success" @click="goMessageBox"
                    >ÂèëÈÄÅ‰ø°ÊÅØ</el-button
                  >
                  <el-button
                    v-if="info.relation == 0"
                    type="info"
                    @click="friendCommand('offblacklist')"
                    >ÂèñÊ∂àÊãâÈªë</el-button
                  >
                  <el-button
                    v-if="info.relation == 1"
                    type="info"
                    @click="friendCommand('onblacklist')"
                    >ÊãâÈªë</el-button
                  >
                  <el-button type="info" @click="friendCommand('reject')"
                    >Âà†Èô§Â•ΩÂèã</el-button
                  >
                </div>
                <div v-else>
                  <el-button type="success" @click="friendCommand('agree')"
                    >ÂêåÊÑè</el-button
                  >
                  <el-button type="info" @click="friendCommand('reject')"
                    >ÊãíÁªù</el-button
                  >
                </div>
              </div>
              <!--Â¶ÇËÅäÂ§©Á™óÂè£Âàó-->
              <div
                v-if="showBox == 'message'"
                style="height: 100%; display: flex; flex-direction: column"
              >
                <!--Ê†áÈ¢òÊ†è-->
                <div
                  class="bgf5"
                  style="
                    height: 60px;
                    border-bottom: 1px;
                    border-bottom-style: solid;
                    line-height: 60px;
                    font-size: 18px;
                    border-color: #e0e0e0;
                    padding-left: 20px;
                  "
                >
                  {{
                    nowmessagefriend.notes == ""
                      ? nowmessagefriend.nickname
                      : nowmessagefriend.notes
                  }}
                </div>
                <!--‰∏ª‰ΩìÊ†è-->
                <div
                  ref="main1"
                  class="bgf5 scroll_config"
                  style="flex: 1; overflow-y: auto"
                >
                  <div style="height: 100%">
                    <div v-for="(item, index) in nowmessagelist" :key="index">
                      <div
                        v-if="item.status == 0"
                        class="flex"
                        style="width: 100%; padding-top: 10px"
                      >
                        <el-avatar
                          shape="square"
                          :src="nowmessagefriend.headimg"
                          :size="40"
                          style="margin-left: 20px"
                        ></el-avatar>
                        <div
                          style="
                            margin-left: 10px;
                            margin-right: 20%;
                            padding: 10px;
                            background-color: #ffffff;
                            font-size: 14px;
                            border-radius: 4px;
                            border: 1px;
                            border-style: solid;
                            border-color: #e0e0e0;
                          "
                        >
                          {{ item.body }}
                        </div>
                      </div>
                      <div
                        v-if="item.status == 1"
                        class="flex"
                        style="
                          width: 100%;
                          padding-top: 10px;
                          justify-content: flex-end;
                        "
                      >
                        <div
                          style="
                            margin-right: 10px;
                            margin-left: 20%;
                            padding: 10px;
                            background-color: #9eea6a;
                            font-size: 14px;
                            border-radius: 4px;
                            border: 1px;
                            border-style: solid;
                            border-color: #e0e0e0;
                          "
                        >
                          {{ item.body }}
                        </div>
                        <el-avatar
                          shape="square"
                          :src="userinfo.headimg"
                          :size="40"
                          style="margin-right: 20px"
                        ></el-avatar>
                      </div>
                    </div>
                  </div>
                </div>
                <!--ËæìÂÖ•Ê†è-->
                <div
                  style="
                    border-top: 1px;
                    border-top-style: solid;
                    border-color: #e0e0e0;
                    background-color: #ffffff;
                    padding-left: 20px;
                    padding-right: 20px;
                    height: 120px;
                  "
                >
                  <!--Â∑•ÂÖ∑Ê†è-->
                  <div style="height: 30px; background-color: #ffffff">
                    <el-dropdown
                      trigger="click"
                      :hide-on-click="false"
                      placement="top"
                    >
                      <span class="el-dropdown-link">üòÉ</span>
                      <el-dropdown-menu slot="dropdown">
                        <el-dropdown-item style="width: 250px">
                          <a
                            v-for="item in emoji"
                            :key="item"
                            @click="inputemoji(item)"
                            style="font-size: 18px"
                            >{{ item }}</a
                          >
                        </el-dropdown-item>
                      </el-dropdown-menu>
                    </el-dropdown>
                  </div>
                  <!--ÂèëÈÄÅÂÜÖÂÆπÊ†è-->
                  <div style="width: 100%">
                    <textarea
                      v-model="sendmessage"
                      placeholder
                      style="
                        height: 60px;
                        border: none;
                        resize: none;
                        width: 100%;
                        padding: 0px;
                        outline: none;
                      "
                    />
                  </div>
                  <!--ÂèëÈÄÅÊåâÈíÆ-->
                  <div
                    class="flex"
                    style="
                      justify-content: flex-end;
                      margin-left: auto;
                      padding-right: 20px;
                    "
                    @click="sendMessage"
                  >
                    <el-button type style="padding: 4px 20px">ÂèëÈÄÅ</el-button>
                  </div>
                </div>
              </div>
              <!--Â¶Ç‰∏™‰∫∫ËµÑÊñôÂàó-->
              <div v-if="showBox == 'myself'" style="padding: 60px">
                <!--Âü∫Á°Ä‰ø°ÊÅØ-->
                <div class="flex">
                  <!--Â§¥ÂÉè-->
                  <div style="width: 80px; height: 80px">
                    <el-upload
                      class="avatar-uploader"
                      action="http://api.25cl.cn/project/chat/headimgupload"
                      :headers="headers"
                      :show-file-list="false"
                      :on-success="handleAvatarSuccess"
                      :before-upload="beforeAvatarUpload"
                      style="width: 80px; height: 80px"
                    >
                      <el-avatar
                        v-if="myselfinfo.headimg"
                        :src="myselfinfo.headimg"
                        class="avatar"
                        :size="80"
                        shape="square"
                      />
                    </el-upload>
                  </div>
                  <div style="margin-left: 20px">
                    <input
                      class="inputupdate"
                      style="
                        padding: 0;
                        margin-top: 4px;
                        border: 0;
                        height: 24px;
                        font-size: 16px;
                        background: #ffffff00;
                      "
                      v-model="myselfinfo.nickname"
                    />
                    <input
                      class="inputupdate"
                      style="
                        padding: 0;
                        margin-top: 4px;
                        border: 0;
                        height: 20px;
                        font-size: 12px;
                        background: #ffffff00;
                        color: #696969;
                      "
                      v-model="myselfinfo.signature"
                    />
                  </div>
                </div>
                <el-divider></el-divider>
                <div>
                  <div class="flex lh40">
                    <span class="w50 c696969">Ë¥¶Âè∑Ôºö</span>
                    <span>{{ myselfinfo.uid }}</span>
                  </div>
                  <div class="flex lh40">
                    <span class="w50 c696969">ÁîüÊó•Ôºö</span>
                    <el-date-picker
                      class="dateinput"
                      v-model="myselfinfo.birthday"
                      type="date"
                      format="yyyy Âπ¥ MM Êúà dd Êó•"
                      value-format="yyyy-MM-dd"
                      prefix-icon="none"
                      :clearable="false"
                      style="padding: 0px"
                    ></el-date-picker>
                  </div>
                  <div class="flex lh40" @click="dialogAddressVisible = true">
                    <span class="w50 c696969">Âú∞ÂùÄÔºö</span>
                    <span>{{ myselfinfo.address }}</span>
                  </div>
                  <div class="flex lh40">
                    <span class="w50 c696969">ÊÄßÂà´Ôºö</span>
                    <div class="lh40">
                      <img
                        v-if="myselfinfo.sex == 0"
                        src="http://api.25cl.cn/static/img/0.png"
                        style="width: 16px; height: 16px; padding-top: 12px"
                        @click="myselfinfo.sex = 1"
                      />
                      <img
                        v-else
                        src="http://api.25cl.cn/static/img/1.png"
                        style="width: 16px; height: 16px; padding-top: 12px"
                        @click="myselfinfo.sex = 0"
                      />
                    </div>
                  </div>
                </div>
                <el-divider></el-divider>
                <el-button @click="updateMyself">‰øùÂ≠ò‰øÆÊîπ</el-button>
              </div>
            </el-col>
          </el-row>
        </el-col>
        <el-col :span="6"></el-col>
        <el-dialog
          title="ÁôªÂΩïÁïåÈù¢"
          :visible.sync="dialogLoginVisible"
          width="300px"
        >
          <el-form>
            <el-form-item label="Áî®Êà∑Âêç" label-width="60px">
              <el-input v-model="username"></el-input>
            </el-form-item>
            <el-form-item label="ÂØÜÁ†Å" label-width="60px">
              <el-input v-model="password"></el-input>
            </el-form-item>
            <el-form-item>
              <el-button type="primary" @click="login">ÁôªÂΩï</el-button>
              <el-button @click="dialogLoginVisible = false">ÂèñÊ∂à</el-button>
            </el-form-item>
          </el-form>
        </el-dialog>
        <el-dialog
          title="Ê≥®ÂÜåÁïåÈù¢"
          :visible.sync="dialogRegistVisible"
          width="500px"
        >
          <el-form
            :model="regForm"
            :rules="rules"
            ref="regForm"
            class="demo-ruleForm"
          >
            <el-form-item
              label="ÊòµÁß∞"
              label-width="80px"
              style="margin-bottom: 20px"
              prop="regnickname"
            >
              <el-input v-model="regForm.regnickname"></el-input>
            </el-form-item>
            <el-form-item
              label="Ë¥¶Âè∑"
              label-width="80px"
              style="margin-bottom: 20px"
              prop="reguid"
            >
              <el-input v-model="regForm.reguid"></el-input>
            </el-form-item>
            <el-form-item
              label="ÂØÜÁ†Å"
              label-width="80px"
              style="margin-bottom: 20px"
              prop="regpass"
            >
              <el-input
                v-model="regForm.regpass"
                show-password
                autocomplete="off"
              ></el-input>
            </el-form-item>
            <el-form-item
              label="ÂØÜÁ†Å"
              label-width="80px"
              style="margin-bottom: 20px"
              prop="checkPass"
            >
              <el-input
                v-model="regForm.checkPass"
                show-password
                autocomplete="off"
              ></el-input>
            </el-form-item>
            <el-form-item
              label="ÈÇÆÁÆ±"
              label-width="80px"
              style="margin-bottom: 20px"
              prop="regemail"
            >
              <el-input v-model="regForm.regemail">
                <el-button slot="append" @click="sendRegisterCode"
                  >Ëé∑ÂèñÈ™åËØÅÁ†Å</el-button
                >
              </el-input>
            </el-form-item>
            <el-form-item
              label="È™åËØÅÁ†Å"
              label-width="80px"
              style="margin-bottom: 20px"
            >
              <el-input v-model="regForm.code"></el-input>
            </el-form-item>
            <el-form-item>
              <el-button type="primary" @click="regist">Ê≥®ÂÜå</el-button>
              <el-button @click="dialogRegistVisible = false">ÂèñÊ∂à</el-button>
            </el-form-item>
          </el-form>
        </el-dialog>
        <el-dialog
          title="Âú∞ÂùÄÈÄâÊã©Âô®"
          :visible.sync="dialogAddressVisible"
          width="400px"
        >
          <v-distpicker
            @province="selectProvince"
            @city="selectCity"
            @area="selectDist"
          ></v-distpicker>
          <el-divider></el-divider>
          <el-button type @click="saveaddress">Á°ÆËÆ§</el-button>
          <el-button type @click="dialogAddressVisible = false">ÂèñÊ∂à</el-button>
        </el-dialog>
        <el-dialog
          title="Ê∑ªÂä†Â•ΩÂèã"
          :visible.sync="dialogAddFriendVisible"
          width="400px"
        >
          <el-form>
            <el-form-item label="Ë¥¶Âè∑" label-width="60px">
              <el-input v-model="addFriendUid" placeholder>
                <el-button slot="append" @click="selectUser">Êü•ËØ¢</el-button>
              </el-input>
              <el-card
                v-if="selectUserInfo.uid"
                style="height: 146px; margin-top: 8px"
              >
                <div class="flex">
                  <div>
                    <el-avatar
                      shape="square"
                      :size="44"
                      :src="selectUserInfo.headimg"
                    ></el-avatar>
                  </div>
                  <div style="margin-left: 14px">
                    <div style="line-height: 14px">
                      {{ selectUserInfo.nickname }}
                    </div>
                    <div
                      style="
                        font-size: 12px;
                        color: #696969;
                        margin-top: 12px;
                        line-height: 14px;
                      "
                    >
                      {{ selectUserInfo.signature }}
                    </div>
                  </div>
                </div>
                <el-button style="margin-top: 10px" @click="addFriend"
                  >Áî≥ËØ∑Â•ΩÂèã</el-button
                >
              </el-card>
            </el-form-item>
          </el-form>
        </el-dialog>
        <div
          id="menu"
          class="menu"
          v-show="menuVisible"
          style="
            position: absolute;
            z-index: 99999;
            background-color: #ffffff;
            font-size: 12px;
            border: 1px;
            border-style: solid;
            border-color: #e0e0e0;
          "
        >
          <el-button @click="removeMessage">Âà†Èô§</el-button>
        </div>
      </el-row>
    </el-main>
  </el-container>
</template>
<style>
</style>
<script>
import axios from 'axios'
import VDistpicker from 'v-distpicker'
export default {
  components: { VDistpicker },
  data () {
    var validatePass = (rule, value, callback) => {
      if (value.length < 8) {
        callback(new Error('ÂØÜÁ†ÅÈïøÂ∫¶Â∫îÂ§ß‰∫é 8 ‰Ωç'))
      } else if (this.ruleForm.checkPass !== value) {
        callback(new Error('‰∏§Ê¨°ËæìÂÖ•ÂØÜÁ†Å‰∏ç‰∏ÄËá¥!'))
      } else {
        callback()
      }
    }
    var validatePass2 = (rule, value, callback) => {
      if (value.length < 8) {
        callback(new Error('ËØ∑ÂÜçÊ¨°ËæìÂÖ•ÂØÜÁ†Å'))
      } else if (value !== this.regForm.regpass) {
        callback(new Error('‰∏§Ê¨°ËæìÂÖ•ÂØÜÁ†Å‰∏ç‰∏ÄËá¥!'))
      } else {
        callback()
      }
    }
    var validateEmail = (rulem, value, callback) => {
      let email = /^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/
      if (!email.test(value)) {
        callback(new Error('ËØ∑ËæìÂÖ•Ê≠£Á°ÆÁöÑÈÇÆÁÆ±Âè∑Á†Å'))
      } else {
        callback()
      }
    }
    return {
      // ÊòüÊúü
      emoji: [
        'üòÄ',
        'üòÅ',
        'üòÇ',
        'üòÉ',
        'üòÑ',
        'üòÖ',
        'üòÜ',
        'üòâ',
        'üòä',
        'üòã',
        'üòé',
        'üòç',
        'üòò',
        'üòó',
        'üòô',
        'üòö',
        'üòá',
        'üòê',
        'üòë',
        'üò∂',
        'üòè',
        'üò£',
        'üò•',
        'üòÆ',
        'üòØ',
        'üò™',
        'üò´',
        'üò¥',
        'üòå',
        'üòõ',
        'üòú',
        'üòù',
        'üòí',
        'üòì',
        'üòî',
        'üòï',
        'üò≤',
        'üò∑',
        'üòñ',
        'üòû',
        'üòü',
        'üò§',
        'üò¢',
        'üò≠',
        'üò¶',
        'üòß',
        'üò®',
        'üò¨',
        'üò∞',
        'üò±',
        'üò≥',
        'üòµ',
        'üò°',
        'üò†'
      ],
      week: [
        'ÊòüÊúüÂ§©',
        'ÊòüÊúü‰∏Ä',
        'ÊòüÊúü‰∫å',
        'ÊòüÊúü‰∏â',
        'ÊòüÊúüÂõõ',
        'ÊòüÊúü‰∫î',
        'ÊòüÊúüÂÖ≠'
      ],
      // Âú∞ÂùÄÈÄâÊã©Âô®ÂèÇÊï∞
      address: {
        province: '',
        city: '',
        dist: ''
      },
      // ËØ∑Ê±ÇÂ§¥ÈÉ®
      headers: {
        token: '',
        userid: ''
      },
      // Ë¶ÅÊ∑ªÂä†ÁöÑÂ•ΩÂèãË¥¶Âè∑
      addFriendUid: '',
      selectUserInfo: '',
      // Â•ΩÂèã‰ø°ÊÅØ
      info: {},
      // Â•ΩÂèãÂàóË°®
      friendList: [],
      // Ê∂àÊÅØÂàóË°®
      messageList: [],
      removeMessageUid: '',
      // ÂΩìÂâçËÅäÂ§©ÂàóË°®
      nowmessagelist: [],
      // ÂΩìÂâçËÅäÂ§©ÂØπË±°
      nowmessagefriend: [],
      // ËÅäÂ§©ËæìÂÖ•Ê°Ü
      sendmessage: '',
      // ÊéßÂà∂ÂàóË°®ÊòæÁ§∫
      showList: 'index',
      // ÊéßÂà∂Á™óÂè£ÊòæÁ§∫
      showBox: 'message',
      key: '',
      // ÁôªÂΩïÂºπÁ™óÊéßÂà∂
      dialogLoginVisible: false,
      // Ê≥®ÂÜåÂºπÁ™óÊéßÂà∂
      dialogRegistVisible: false,
      // Âú∞ÂùÄÈÄâÊã©Âô®ÂºπÁ™óÊéßÂà∂
      dialogAddressVisible: false,
      // Ê∑ªÂä†Â•ΩÂèãÂºπÁ™óÊéßÂà∂
      dialogAddFriendVisible: false,
      menuVisible: false,
      // Áî®Êà∑Âêç
      username: '',
      // ÂØÜÁ†Å
      password: '',
      // Áî®Êà∑‰ø°ÊÅØ
      userinfo: '',
      // ‰∏™‰∫∫‰ø°ÊÅØ ‰øÆÊîπ
      myselfinfo: '',
      // token
      usertoken: '',
      //  websocketÂØπË±°
      path: 'ws://47.94.109.216:8282',
      ws: '',
      // Ê≥®ÂÜå
      regForm: {
        regnickname: '',
        reguid: '',
        regpass: '',
        checkPass: '',
        regemail: '',
        code: ''
      },
      rules: {
        regnickname: [
          { required: true, message: 'ËØ∑ËæìÂÖ•ÊòµÁß∞', trigger: 'blur' },
          { max: 18, message: 'ÈïøÂ∫¶Â∫îÂ∞è‰∫é 18 ‰∏™Â≠óÁ¨¶', trigger: 'blur' }
        ],
        reguid: [
          { required: true, message: 'ËØ∑ËæìÂÖ•Ë¥¶Âè∑', trigger: 'blur' },
          {
            min: 6,
            max: 18,
            message: 'ÈïøÂ∫¶Âú® 6 Âà∞ 16 ‰∏™Â≠óÁ¨¶',
            trigger: 'blur'
          }
        ],
        regpass: [{ validator: validatePass, trigger: 'blur' }],
        checkPass: [{ validator: validatePass2, trigger: 'blur' }],
        regemail: [{ validator: validateEmail, trigger: 'blur' }]
      }
    }
  },
  methods: {
    /**
     * websocket Áõ∏ÂÖ≥Êìç‰Ωú
     * init ÂàùÂßãÂåñ
     * onopen ËøûÊé•ÊàêÂäü‰∫ã‰ª∂
     * onerror ËøûÊé•Â§±Ë¥•‰∫ã‰ª∂
     * onmessage ÁõëÂê¨‰∫ã‰ª∂
     */
    init () {
      var that = this
      if (typeof WebSocket === 'undefined') {
        alert('ÊµèËßàÂô®‰∏çÊîØÊåÅ')
      } else {
        that.ws = new WebSocket(that.path)
        that.ws.onopen = that.onopen
        that.ws.operror = that.onerror
        that.ws.onmessage = that.onmessage
      }
    },
    onopen () {
      console.log('ËøûÊé•ÊàêÂäü')
    },
    onerror () {
      console.log('ËøûÊé•ÈîôËØØ')
    },
    onmessage (msg) {
      let that = this
      let re = JSON.parse(msg.data)
      if (re.fuid === 'success') {
        console.log(re.message)
      } else if (re.fuid === 'error') {
        console.log(re.message)
      } else {
        if (re.fuid === that.nowmessagefriend.fuid) {
          that.nowmessagelist.push({
            status: 0,
            body: re.message,
            chattime: re.chattime
          })
          that.$nextTick(() => {
            that.$refs.main1.scrollTop = that.$refs.main1.scrollHeight
          })
        }
        if (that.showList === 'message') {
          that.updateMessageList()
        }
      }
    },
    // ÁôªÂΩï
    login () {
      var that = this
      axios
        .get('http://api.25cl.cn/project/chat/login', {
          params: {
            username: that.username,
            password: that.password
          }
        })
        .then((res) => {
          if (res.data) {
            that.dialogLoginVisible = false
            that.userinfo = res.data.userinfo
            that.headers.token = res.data.token
            that.headers.userid = that.username
            that.ws.send('{"code":"login","uid":"' + that.username + '"}')
            that.$message({
              message: 'ÁôªÂΩïÊàêÂäü',
              type: 'success'
            })
            console.log(that.userinfo)
          } else {
            console.log('false')
            that.$message({
              message: 'ÁôªÂΩïÂ§±Ë¥•',
              type: 'error'
            })
          }
        })
    },
    // Ê≥®ÂÜå
    regist () {
      let that = this
      let params = new URLSearchParams()
      params.append('reguid', that.regForm.reguid)
      params.append('regpassword', that.regForm.regpass)
      params.append('regpassword1', that.regForm.checkPass)
      params.append('regnickname', that.regForm.regnickname)
      params.append('regemail', that.regForm.regemail)
      params.append('regcode', that.regForm.code)
      console.log(params)
      axios.post('http://api.25cl.cn/project/chat/register', params)
    },
    // ÊòæÁ§∫Â•ΩÂèãÂàóË°®
    showFriendList () {
      this.showList = 'friend'
      this.updateFriendList()
    },
    // Êõ¥Êñ∞Â•ΩÂèãÂàóË°®
    updateFriendList () {
      let that = this
      console.log('update')
      axios
        .get('http://api.25cl.cn/project/chat/updateShow', {
          params: {
            status: 'friendlist'
          },
          headers: that.headers
        })
        .then((res) => {
          console.log(res)
          that.friendList = res.data
        })
    },
    // ÊòæÁ§∫ËÅäÂ§©ÂàóË°®
    showMessageList () {
      this.showList = 'message'
      this.updateMessageList()
    },
    // ÁßªÂá∫ËÅäÂ§©ÂàóË°®
    removeMessage () {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/friendcommand', {
          params: {
            command: 'removeMessage',
            fuid: that.removeMessageUid
          },
          headers: that.headers
        })
        .then((res) => {
          that.showMessageList()
        })
    },
    // Êõ¥Êñ∞ËÅäÂ§©ÂàóË°®
    updateMessageList () {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/updateShow', {
          params: {
            status: 'chatlist'
          },
          headers: that.headers
        })
        .then((res) => {
          console.log(res)
          that.messageList = res.data
        })
    },
    // ÂèëÈÄÅ‰ø°ÊÅØÊåâÈíÆË∑≥ËΩ¨Ëá≥ËÅäÂ§©Á™óÂè£
    goMessageBox () {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/friendcommand', {
          params: {
            fuid: that.info.fuid,
            command: 'addchatlist'
          },
          headers: that.headers
        })
        .then((res) => {
          that.openMessage(that.info)
          that.showMessageList()
        })
    },
    // Ëé∑ÂèñÈ™åËØÅÁ†Å
    sendRegisterCode () {
      let that = this
      let params = new URLSearchParams()
      params.append('email', that.regForm.regemail)
      console.log(params)
      axios.post('http://api.25cl.cn/project/chat/addRegisterCode', params)
    },
    // Êü•ËØ¢Áî®Êà∑
    selectUser () {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/selectUser', {
          params: {
            selectUser: that.addFriendUid
          },
          headers: that.headers
        })
        .then((res) => {
          that.selectUserInfo = res.data
        })
      console.log(that.selectUserInfo)
    },
    // Ê∑ªÂä†Â•ΩÂèã
    addFriend () {
      let that = this
      axios.get('http://api.25cl.cn/project/chat/addFriend', {
        params: {
          fuid: that.selectUserInfo.uid,
          time: Date.parse(new Date()) / 100
        },
        headers: that.headers
      })
    },
    // Â•ΩÂèãÁõ∏ÂÖ≥Êìç‰Ωú
    friendCommand (command) {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/friendcommand', {
          params: {
            fuid: that.info.fuid,
            command: command
          },
          headers: that.headers
        })
        .then((res) => {
          if (that.showList === 'friend') {
            that.updateFriendList()
          }
          if (command === 'onblacklist') {
            that.info.relation = 0
          } else if (command === 'offblacklist') {
            that.info.relation = 1
          } else if (command === 'agree') {
            that.info.relation = 1
          }
        })
    },
    // ÊâìÂºÄÊ∂àÊÅØÁ™óÂè£
    openMessage (item) {
      let that = this
      that.nowmessagelist = []
      that.updateMessage(item.fuid, new Date().valueOf(), 0)
      that.nowmessagefriend = item
      console.log(item)
      that.sendmessage = ''
      that.showBox = 'message'
    },
    // Êõ¥Êñ∞Ê∂àÊÅØ
    updateMessage (fuid, chattime, status) {
      let that = this
      axios
        .get('http://api.25cl.cn/project/chat/selectMessage', {
          params: {
            fuid: fuid,
            chattime: chattime,
            status: status
          },
          headers: that.headers
        })
        .then((res) => {
          console.log(res)
          let arr = res.data.reverse()
          for (let index = 0; index < arr.length; index++) {
            that.nowmessagelist.push(arr[index])
            that.$nextTick(() => {
              that.$refs.main1.scrollTop = that.$refs.main1.scrollHeight
            })
          }
        })
    },
    // ÂèëÈÄÅÊ∂àÊÅØ
    sendMessage () {
      let that = this
      let mtime = Date.now()
      that.nowmessagelist.push({
        status: 1,
        body: that.sendmessage,
        chattime: mtime
      })
      console.log(that.nowmessagelist)
      console.log(
        '{"code":"send","fuid":"' +
          that.nowmessagefriend.fuid +
          '","message":"' +
          that.sendmessage +
          '","time":"' +
          mtime +
          '"}'
      )
      that.ws.send(
        '{"code":"send","fuid":"' +
          that.nowmessagefriend.fuid +
          '","message":"' +
          that.sendmessage +
          '","time":"' +
          mtime +
          '"}'
      )
      that.sendmessage = ''
      that.$nextTick(() => {
        that.$refs.main1.scrollTop = that.$refs.main1.scrollHeight
      })
      that.updateMessageList()
    },
    // Êõ¥Êñ∞Â•ΩÂèãÂ§áÊ≥®
    updateFriendNote (event) {
      let that = this
      that.info.notes = event.currentTarget.value
      console.log(event.currentTarget.value)
      axios
        .get('http://api.25cl.cn/project/chat/updatefriendnote', {
          params: {
            fuid: that.info.fuid,
            notes: event.currentTarget.value
          },
          headers: that.headers
        })
        .then((res) => {
          that.updateFriendList()
        })
    },
    // ÊòæÁ§∫Â•ΩÂèã‰ø°ÊÅØ
    showFriendInfo (item) {
      this.showBox = 'info'
      this.info = ''
      this.info = item
      console.log(item)
    },
    // ÊòæÁ§∫Ëá™Â∑±‰ø°ÊÅØ
    showmyself () {
      console.log(this.userinfo)
      this.myselfinfo = { ...this.userinfo }
      this.showBox = 'myself'
    },
    // Êõ¥Êñ∞Ëá™Â∑±‰ø°ÊÅØ
    updateMyself () {
      let that = this
      console.log(that.myselfinfo)
      axios
        .get('http://api.25cl.cn/project/chat/savemyselfinfo', {
          params: {
            nickname: that.myselfinfo.nickname,
            sex: that.myselfinfo.sex,
            birthday: that.myselfinfo.birthday,
            signature: that.myselfinfo.signature,
            address: that.myselfinfo.address
          },
          headers: that.headers
        })
        .then((res) => {
          that.userinfo = res.data
        })
    },
    // ‰øùÂ≠òÂú∞ÂùÄ
    saveaddress () {
      let that = this
      console.log(that.userinfo)
      that.myselfinfo.address =
        (that.address.province === that.address.city
          ? that.address.province
          : that.address.province + ' ' + that.address.city) +
        ' ' +
        that.address.dist
      console.log(that.myselfinfo)
      that.dialogAddressVisible = false
    },
    // Âú∞ÂùÄÈÄâÊã©Âô®--ÁúÅ
    selectProvince (e) {
      if (e.value.length > 2) {
        this.address.province = e.value
      } else {
        this.address.province = ''
      }
    },
    // Âú∞ÂùÄÈÄâÊã©Âô®--Â∏Ç
    selectCity (e) {
      if (e.value.length > 2) {
        this.address.city = e.value
      } else {
        this.address.city = ''
      }
    },
    // Âú∞ÂùÄÈÄâÊã©Âô®--Âå∫
    selectDist (e) {
      if (e.value.length > 2) {
        this.address.dist = e.value
      } else {
        this.address.dist = ''
      }
    },
    handleAvatarSuccess (res, file) {
      this.myselfinfo.headimg = URL.createObjectURL(file.raw)
      this.userinfo.headimg = URL.createObjectURL(file.raw)
    },
    beforeAvatarUpload (file) {
      const isJPG = file.type === 'image/jpeg'
      const isLt2M = file.size / 1024 / 1024 < 2

      if (!isJPG) {
        this.$message.error('‰∏ä‰º†Â§¥ÂÉèÂõæÁâáÂè™ËÉΩÊòØ JPG Ê†ºÂºè!')
      }
      if (!isLt2M) {
        this.$message.error('‰∏ä‰º†Â§¥ÂÉèÂõæÁâáÂ§ßÂ∞è‰∏çËÉΩË∂ÖËøá 2MB!')
      }
      return isJPG && isLt2M
    },
    inputemoji (item) {
      this.sendmessage += item
      console.log(this.sendmessage)
    },
    rightClick (uid) {
      // Èº†Ê†áÂè≥ÂáªËß¶Âèë‰∫ã
      event.preventDefault()
      this.menuVisible = false // ÂÖàÊääÊ®°ÊÄÅÊ°ÜÂÖ≥Ê≠ªÔºåÁõÆÁöÑÊòØ Á¨¨‰∫åÊ¨°ÊàñËÄÖÁ¨¨nÊ¨°Âè≥ÈîÆÈº†Ê†áÁöÑÊó∂ÂÄô ÂÆÉÈªòËÆ§ÁöÑÊòØtrue
      this.menuVisible = true // ÊòæÁ§∫Ê®°ÊÄÅÁ™óÂè£ÔºåË∑≥Âá∫Ëá™ÂÆö‰πâËèúÂçïÊ†è
      var menu = document.querySelector('#menu')
      menu.style.left = event.clientX + 5 + 'px'
      document.addEventListener('click', this.foo) // ÁªôÊï¥‰∏™documentÊ∑ªÂä†ÁõëÂê¨Èº†Ê†á‰∫ã‰ª∂ÔºåÁÇπÂáª‰ªª‰Ωï‰ΩçÁΩÆÊâßË°åfooÊñπÊ≥ï
      menu.style.top = event.clientY - 80 + 'px'
      console.log(uid)
      this.removeMessageUid = uid
    },

    foo () {
      // ÂèñÊ∂àÈº†Ê†áÁõëÂê¨‰∫ã‰ª∂ ËèúÂçïÊ†è
      this.menuVisible = false

      document.removeEventListener('click', this.foo) // Ë¶ÅÂèäÊó∂ÂÖ≥ÊéâÁõëÂê¨Ôºå‰∏çÂÖ≥ÊéâÁöÑÊòØ‰∏Ä‰∏™ÂùëÔºå‰∏ç‰ø°‰Ω†ËØïËØïÔºåËôΩÁÑ∂ÂâçÂè∞ÊòæÁ§∫ÁöÑÊó∂ÂÄôÊ≤°ÊúâÂï•ÊØõÁóÖÔºåÂä†‰∏Ä‰∏™alert‰Ω†Â∞±Áü•ÈÅì‰∫Ü
    },
    chattimeFormatter (value) {
      console.log(value)
      var date = new Date(parseInt(value)) // Êó∂Èó¥Êà≥‰∏∫10‰ΩçÈúÄ*1000ÔºåÊó∂Èó¥Êà≥‰∏∫13‰ΩçÁöÑËØù‰∏çÈúÄ‰πò1000
      console.log(date)
      let y = date.getYear()
      let M = date.getMonth() + 1
      let d = date.getDate()
      let week = date.getDay()
      let h = date.getHours()
      let m = date.getMinutes()
      var nowDate = new Date()
      let nowy = nowDate.getYear()
      let nowM = nowDate.getMonth() + 1
      let nowd = nowDate.getDate()
      let nowweek = nowDate.getDay()
      if (nowy === y && nowM === M) {
        if (nowd === d) {
          return h + ':' + (m < 10 ? '0' + m : m)
        } else if (nowd - 1 === d) {
          return 'Êò®Â§©'
        } else if (nowd - nowweek <= d) {
          return this.week[week]
        } else {
          return (y + '').substr(1, 2) + '/' + M + '/' + d
        }
      } else {
        return (y + '').substr(1, 2) + '/' + M + '/' + d
      }
    }
  },
  mounted () {
    this.init()
  }
}
</script>
